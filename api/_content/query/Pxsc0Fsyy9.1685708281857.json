{"_path":"/nuxt3/features/shared-state","_dir":"features","_draft":false,"_partial":false,"_locale":"","_empty":false,"title":"状态共享","description":"","body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"状态共享"},"children":[{"type":"text","value":"状态共享"}]},{"type":"element","tag":"iframe-video","props":{"aid":"937848939","bvid":"BV1TT4y1v7BQ","cid":"565583657"},"children":[]},{"type":"element","tag":"h2","props":{"id":"基础"},"children":[{"type":"text","value":"基础"}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"使用 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"useState"}]},{"type":"text","value":" 可以定义简单的共享状态"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"例如在 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"composables"}]},{"type":"text","value":" 中定义 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"useCounter"}]}]},{"type":"element","tag":"code","props":{"code":"// composables/useCounter.ts\n// composables 下模块的同名导出将被自动按需引入\nexport const useCounter = () => useState('counter', () => 100)\n","language":"ts","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-3e5a8c"},"children":[{"type":"text","value":"// composables/useCounter.ts\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"class":"ct-3e5a8c"},"children":[{"type":"text","value":"// composables 下模块的同名导出将被自动按需引入\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"class":"ct-f0dac9"},"children":[{"type":"text","value":"export"}]},{"type":"element","tag":"span","props":{"class":"ct-565fc7"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-f0dac9"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"class":"ct-565fc7"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-a29f58"},"children":[{"type":"text","value":"useCounter"}]},{"type":"element","tag":"span","props":{"class":"ct-565fc7"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-f0dac9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-565fc7"},"children":[{"type":"text","value":" () "}]},{"type":"element","tag":"span","props":{"class":"ct-f0dac9"},"children":[{"type":"text","value":"=>"}]},{"type":"element","tag":"span","props":{"class":"ct-565fc7"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-a29f58"},"children":[{"type":"text","value":"useState"}]},{"type":"element","tag":"span","props":{"class":"ct-565fc7"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-b9c072"},"children":[{"type":"text","value":"'counter'"}]},{"type":"element","tag":"span","props":{"class":"ct-565fc7"},"children":[{"type":"text","value":", () "}]},{"type":"element","tag":"span","props":{"class":"ct-f0dac9"},"children":[{"type":"text","value":"=>"}]},{"type":"element","tag":"span","props":{"class":"ct-565fc7"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-8b0f3f"},"children":[{"type":"text","value":"100"}]},{"type":"element","tag":"span","props":{"class":"ct-565fc7"},"children":[{"type":"text","value":")"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"useState"}]},{"type":"text","value":" 的第一参数为 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"key"}]},{"type":"text","value":"，第二参数为初始化的工厂函数"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"此时在 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"index"}]},{"type":"text","value":" 页面中可以直接使用 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"useCounter"}]}]},{"type":"element","tag":"code","props":{"code":"<!-- pages/index.vue -->\n<script lang=\"ts\" setup>\n    const conuter = useCounter() // 这是按需自动引入的\n</script>\n\n<template>\n    <div> <!-- 顶层的 div 包裹是必需的，不然跳转会丢失状态 -->\n        <div @click=\"conuter++\">{{ conuter }}</div>\n        <NuxtLink to=\"/home\">to home</NuxtLink>\n    </div>\n</template>\n","language":"html","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-3e5a8c"},"children":[{"type":"text","value":"<!-- pages/index.vue -->\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"class":"ct-565fc7"},"children":[{"type":"text","value":"<"}]},{"type":"element","tag":"span","props":{"class":"ct-aa2043"},"children":[{"type":"text","value":"script"}]},{"type":"element","tag":"span","props":{"class":"ct-565fc7"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-8b0f3f"},"children":[{"type":"text","value":"lang"}]},{"type":"element","tag":"span","props":{"class":"ct-565fc7"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-b9c072"},"children":[{"type":"text","value":"\"ts\""}]},{"type":"element","tag":"span","props":{"class":"ct-565fc7"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-8b0f3f"},"children":[{"type":"text","value":"setup"}]},{"type":"element","tag":"span","props":{"class":"ct-565fc7"},"children":[{"type":"text","value":">\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"class":"ct-565fc7"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-f0dac9"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"class":"ct-565fc7"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-8b0f3f"},"children":[{"type":"text","value":"conuter"}]},{"type":"element","tag":"span","props":{"class":"ct-565fc7"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-f0dac9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-565fc7"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-a29f58"},"children":[{"type":"text","value":"useCounter"}]},{"type":"element","tag":"span","props":{"class":"ct-565fc7"},"children":[{"type":"text","value":"() "}]},{"type":"element","tag":"span","props":{"class":"ct-3e5a8c"},"children":[{"type":"text","value":"// 这是按需自动引入的\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"class":"ct-565fc7"},"children":[{"type":"text","value":"</"}]},{"type":"element","tag":"span","props":{"class":"ct-aa2043"},"children":[{"type":"text","value":"script"}]},{"type":"element","tag":"span","props":{"class":"ct-565fc7"},"children":[{"type":"text","value":">\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"class":"ct-565fc7"},"children":[{"type":"text","value":"<"}]},{"type":"element","tag":"span","props":{"class":"ct-aa2043"},"children":[{"type":"text","value":"template"}]},{"type":"element","tag":"span","props":{"class":"ct-565fc7"},"children":[{"type":"text","value":">\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"class":"ct-565fc7"},"children":[{"type":"text","value":"    <"}]},{"type":"element","tag":"span","props":{"class":"ct-aa2043"},"children":[{"type":"text","value":"div"}]},{"type":"element","tag":"span","props":{"class":"ct-565fc7"},"children":[{"type":"text","value":"> "}]},{"type":"element","tag":"span","props":{"class":"ct-3e5a8c"},"children":[{"type":"text","value":"<!-- 顶层的 div 包裹是必需的，不然跳转会丢失状态 -->\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"class":"ct-565fc7"},"children":[{"type":"text","value":"        <"}]},{"type":"element","tag":"span","props":{"class":"ct-aa2043"},"children":[{"type":"text","value":"div"}]},{"type":"element","tag":"span","props":{"class":"ct-565fc7"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-8b0f3f"},"children":[{"type":"text","value":"@click"}]},{"type":"element","tag":"span","props":{"class":"ct-565fc7"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-b9c072"},"children":[{"type":"text","value":"\"conuter++\""}]},{"type":"element","tag":"span","props":{"class":"ct-565fc7"},"children":[{"type":"text","value":">{{ conuter }}</"}]},{"type":"element","tag":"span","props":{"class":"ct-aa2043"},"children":[{"type":"text","value":"div"}]},{"type":"element","tag":"span","props":{"class":"ct-565fc7"},"children":[{"type":"text","value":">\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"class":"ct-565fc7"},"children":[{"type":"text","value":"        <"}]},{"type":"element","tag":"span","props":{"class":"ct-32a980"},"children":[{"type":"text","value":"NuxtLink"}]},{"type":"element","tag":"span","props":{"class":"ct-565fc7"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-8b0f3f"},"children":[{"type":"text","value":"to"}]},{"type":"element","tag":"span","props":{"class":"ct-565fc7"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-b9c072"},"children":[{"type":"text","value":"\"/home\""}]},{"type":"element","tag":"span","props":{"class":"ct-565fc7"},"children":[{"type":"text","value":">to home</"}]},{"type":"element","tag":"span","props":{"class":"ct-32a980"},"children":[{"type":"text","value":"NuxtLink"}]},{"type":"element","tag":"span","props":{"class":"ct-565fc7"},"children":[{"type":"text","value":">\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"class":"ct-565fc7"},"children":[{"type":"text","value":"    </"}]},{"type":"element","tag":"span","props":{"class":"ct-aa2043"},"children":[{"type":"text","value":"div"}]},{"type":"element","tag":"span","props":{"class":"ct-565fc7"},"children":[{"type":"text","value":">\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{"class":"ct-565fc7"},"children":[{"type":"text","value":"</"}]},{"type":"element","tag":"span","props":{"class":"ct-aa2043"},"children":[{"type":"text","value":"template"}]},{"type":"element","tag":"span","props":{"class":"ct-565fc7"},"children":[{"type":"text","value":">"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"home"}]},{"type":"text","value":" 页面中也可以直接使用"}]},{"type":"element","tag":"code","props":{"code":"<!-- pages/home.vue -->\n<script lang=\"ts\" setup>\n    const conuter = useCounter()\n</script>\n\n<template>\n    <div @click=\"conuter++\">{{ conuter }}</div>\n</template>\n","language":"html","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-3e5a8c"},"children":[{"type":"text","value":"<!-- pages/home.vue -->\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"class":"ct-565fc7"},"children":[{"type":"text","value":"<"}]},{"type":"element","tag":"span","props":{"class":"ct-aa2043"},"children":[{"type":"text","value":"script"}]},{"type":"element","tag":"span","props":{"class":"ct-565fc7"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-8b0f3f"},"children":[{"type":"text","value":"lang"}]},{"type":"element","tag":"span","props":{"class":"ct-565fc7"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-b9c072"},"children":[{"type":"text","value":"\"ts\""}]},{"type":"element","tag":"span","props":{"class":"ct-565fc7"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-8b0f3f"},"children":[{"type":"text","value":"setup"}]},{"type":"element","tag":"span","props":{"class":"ct-565fc7"},"children":[{"type":"text","value":">\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"class":"ct-565fc7"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-f0dac9"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"class":"ct-565fc7"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-8b0f3f"},"children":[{"type":"text","value":"conuter"}]},{"type":"element","tag":"span","props":{"class":"ct-565fc7"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-f0dac9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-565fc7"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-a29f58"},"children":[{"type":"text","value":"useCounter"}]},{"type":"element","tag":"span","props":{"class":"ct-565fc7"},"children":[{"type":"text","value":"()\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"class":"ct-565fc7"},"children":[{"type":"text","value":"</"}]},{"type":"element","tag":"span","props":{"class":"ct-aa2043"},"children":[{"type":"text","value":"script"}]},{"type":"element","tag":"span","props":{"class":"ct-565fc7"},"children":[{"type":"text","value":">\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"class":"ct-565fc7"},"children":[{"type":"text","value":"<"}]},{"type":"element","tag":"span","props":{"class":"ct-aa2043"},"children":[{"type":"text","value":"template"}]},{"type":"element","tag":"span","props":{"class":"ct-565fc7"},"children":[{"type":"text","value":">\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"class":"ct-565fc7"},"children":[{"type":"text","value":"    <"}]},{"type":"element","tag":"span","props":{"class":"ct-aa2043"},"children":[{"type":"text","value":"div"}]},{"type":"element","tag":"span","props":{"class":"ct-565fc7"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-8b0f3f"},"children":[{"type":"text","value":"@click"}]},{"type":"element","tag":"span","props":{"class":"ct-565fc7"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-b9c072"},"children":[{"type":"text","value":"\"conuter++\""}]},{"type":"element","tag":"span","props":{"class":"ct-565fc7"},"children":[{"type":"text","value":">{{ conuter }}</"}]},{"type":"element","tag":"span","props":{"class":"ct-aa2043"},"children":[{"type":"text","value":"div"}]},{"type":"element","tag":"span","props":{"class":"ct-565fc7"},"children":[{"type":"text","value":">\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"class":"ct-565fc7"},"children":[{"type":"text","value":"</"}]},{"type":"element","tag":"span","props":{"class":"ct-aa2043"},"children":[{"type":"text","value":"template"}]},{"type":"element","tag":"span","props":{"class":"ct-565fc7"},"children":[{"type":"text","value":">"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"你会发现两个页面的状态是共享的 👍"}]},{"type":"element","tag":"space","props":{},"children":[]},{"type":"element","tag":"h2","props":{"id":"注意"},"children":[{"type":"text","value":"注意"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"useState"}]},{"type":"text","value":" 只允许在生命周期中使用。"}]},{"type":"element","tag":"style","children":[{"type":"text","value":".ct-32a980{color:#82071E}\n.ct-aa2043{color:#116329}\n.ct-8b0f3f{color:#0550AE}\n.ct-b9c072{color:#0A3069}\n.ct-a29f58{color:#8250DF}\n.ct-565fc7{color:#24292F}\n.ct-f0dac9{color:#CF222E}\n.ct-3e5a8c{color:#6E7781}\n.dark .ct-3e5a8c{color:#8B949E}\n.dark .ct-f0dac9{color:#FF7B72}\n.dark .ct-565fc7{color:#C9D1D9}\n.dark .ct-a29f58{color:#D2A8FF}\n.dark .ct-b9c072{color:#A5D6FF}\n.dark .ct-8b0f3f{color:#79C0FF}\n.dark .ct-aa2043{color:#7EE787}\n.dark .ct-32a980{color:#FFA198}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"基础","depth":2,"text":"基础"},{"id":"注意","depth":2,"text":"注意"}]}},"_type":"markdown","_id":"content:4.nuxt3:2.features:4.shared-state.md","_source":"content","_file":"4.nuxt3/2.features/4.shared-state.md","_extension":"md"}
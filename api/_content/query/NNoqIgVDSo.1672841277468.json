[{"_path":"/vite/plugins/use-modules","_dir":"plugins","_draft":false,"_partial":false,"_locale":"en","_empty":false,"title":"æ¨¡å—è‡ªåŠ¨åŠ è½½","description":"","excerpt":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"æ¨¡å—è‡ªåŠ¨åŠ è½½"},"children":[{"type":"text","value":"æ¨¡å—è‡ªåŠ¨åŠ è½½"}]},{"type":"element","tag":"h2","props":{"id":"ä»“åº“"},"children":[{"type":"text","value":"ä»“åº“"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"æ¨¡å—è‡ªåŠ¨åŠ è½½æ’ä»¶ "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"npm"}]},{"type":"text","value":" åŒ…å·²å®ç°ï¼Œå…·ä½“å¯è§è¯¥ä»“åº“ ğŸ‘‰ "},{"type":"element","tag":"a","props":{"href":"https://github.com/dishait/vite-plugin-use-modules","rel":["nofollow"]},"children":[{"type":"text","value":"vite-plugin-use-modules"}]},{"type":"text","value":"ã€‚"}]},{"type":"element","tag":"br","props":{},"children":[]},{"type":"element","tag":"br","props":{},"children":[]},{"type":"element","tag":"h2","props":{"id":"åŸç†"},"children":[{"type":"text","value":"åŸç†"}]},{"type":"element","tag":"h3","props":{"id":"glob-å¯¼å…¥"},"children":[{"type":"element","tag":"a","props":{"href":"https://cn.vitejs.dev/guide/features.html#glob-import","rel":["nofollow"]},"children":[{"type":"text","value":"Glob å¯¼å…¥"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"åœ¨ "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"vite"}]},{"type":"text","value":" ä¸­æœ‰ä¸ªéå¸¸å¥½ç”¨çš„åŠŸèƒ½å«åš "},{"type":"element","tag":"a","props":{"href":"https://cn.vitejs.dev/guide/features.html#glob-import","rel":["nofollow"]},"children":[{"type":"text","value":"Glob å¯¼å…¥"}]},{"type":"text","value":"ã€‚"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"ä¾‹å¦‚ä½ å¯ä»¥é€šè¿‡ä¸‹è¾¹çš„æ–¹å¼è‡ªåŠ¨å¼•å…¥ "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"src/modules"}]},{"type":"text","value":" ä¸‹çš„æ‰€æœ‰ "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"js"}]},{"type":"text","value":" æ¨¡å—"}]},{"type":"element","tag":"code","props":{"code":"const modules = import.meta.globEager(\n    '/src/modules/**/*.js'\n)\n\nconsole.log(modules) // å°†ä»¥å¯¹è±¡çš„æ–¹å¼è¾“å‡ºåˆ°å‰ç«¯æ§åˆ¶å°\n","language":"js"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"const modules = import.meta.globEager(\n    '/src/modules/**/*.js'\n)\n\nconsole.log(modules) // å°†ä»¥å¯¹è±¡çš„æ–¹å¼è¾“å‡ºåˆ°å‰ç«¯æ§åˆ¶å°\n"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"Glob å¯¼å…¥","src":"/quick/img/globEager.gif"},"children":[]}]},{"type":"element","tag":"br","props":{},"children":[]},{"type":"element","tag":"br","props":{},"children":[]},{"type":"element","tag":"h3","props":{"id":"è‡ªåŠ¨æ³¨å†Œ"},"children":[{"type":"text","value":"è‡ªåŠ¨æ³¨å†Œ"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"æ ¹æ®ä¸Šè¾¹çš„åŸç†ï¼Œæˆ‘ä»¬å°±å¯ä»¥è‡ªåŠ¨æ³¨å†Œ "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"vue"}]},{"type":"text","value":" æ¨¡å—"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"ä¾‹å¦‚æ³¨å†Œ "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"pinia"}]}]},{"type":"element","tag":"code-group","props":{},"children":[{"type":"text","value":"\n  "},{"type":"element","tag":"codegroupitem","props":{"title":"npm","active":""},"children":[{"type":"element","tag":"code","props":{"code":"npm i pinia -D\n","language":"shell"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"npm i pinia -D\n"}]}]}]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n  "},{"type":"element","tag":"codegroupitem","props":{"title":"yarn"},"children":[{"type":"element","tag":"code","props":{"code":"yarn add pinia -D\n","language":"shell"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"yarn add pinia -D\n"}]}]}]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n  "},{"type":"element","tag":"codegroupitem","props":{"title":"pnpm"},"children":[{"type":"element","tag":"code","props":{"code":"pnpm add pinia -D\n","language":"shell"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"pnpm add pinia -D\n"}]}]}]},{"type":"text","value":"\n  "}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"ç„¶ååˆ›å»ºæ¨¡å— "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"src/modules/pinia.js"}]}]},{"type":"element","tag":"code","props":{"code":"// src/modules/pinia.js\nimport { createPinia } from 'pinia'\n\nexport default app => app.use(createPinia())\n","language":"js"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"// src/modules/pinia.js\nimport { createPinia } from 'pinia'\n\nexport default app => app.use(createPinia())\n"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"ç„¶ååœ¨ "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"src/main.js"}]},{"type":"text","value":" ä¸‹ä¹¦å†™ä»¥ä¸‹ä»£ç "}]},{"type":"element","tag":"code","props":{"code":"import App from './App.vue'\nimport { createApp } from 'vue'\n\nconst app = createApp(App)\n\n// å¼•å…¥æ‰€æœ‰æ¨¡å—\nconst modules = import.meta.globEager(\n    '/src/modules/**/*.js'\n)\n// å®‰è£…æ’ä»¶\nObject.values(modules).forEach(module => {\n    if (typeof module.default === 'function') {\n        module.default(app)\n    }\n})\n\napp.mount('#app')\n","language":"js"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"import App from './App.vue'\nimport { createApp } from 'vue'\n\nconst app = createApp(App)\n\n// å¼•å…¥æ‰€æœ‰æ¨¡å—\nconst modules = import.meta.globEager(\n    '/src/modules/**/*.js'\n)\n// å®‰è£…æ’ä»¶\nObject.values(modules).forEach(module => {\n    if (typeof module.default === 'function') {\n        module.default(app)\n    }\n})\n\napp.mount('#app')\n"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"ä»¥ä¸Šå°±ç®—è‡ªåŠ¨æ³¨å†Œ "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"pinia"}]},{"type":"text","value":" æˆåŠŸäº†ï¼Œå¯ä»¥åˆ›å»º "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"src/stores/counter.js"}]},{"type":"text","value":" éªŒè¯ä¸€ä¸‹"}]},{"type":"element","tag":"code","props":{"code":"// src/stores/counter.js\nimport { defineStore } from 'pinia'\n\nexport const useCounterStore = defineStore('counter', {\n    state() {\n        return {\n            counter: 0\n        }\n    },\n    actions: {\n        inc() {\n            this.counter++\n        }\n    }\n})\n","language":"js"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"// src/stores/counter.js\nimport { defineStore } from 'pinia'\n\nexport const useCounterStore = defineStore('counter', {\n    state() {\n        return {\n            counter: 0\n        }\n    },\n    actions: {\n        inc() {\n            this.counter++\n        }\n    }\n})\n"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"æœ€åå°±å¯ä»¥åœ¨ "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"src/App.vue"}]},{"type":"text","value":" ä¸­ä½¿ç”¨äº†"}]},{"type":"element","tag":"code","props":{"code":"<script setup>\n    import { useCounterStore } from './stores/counter'\n\n    const store = useCounterStore()\n</script>\n\n<template>\n    <div @click=\"store.inc()\">{{ store.counter }}</div>\n</template>\n","language":"html"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"<script setup>\n    import { useCounterStore } from './stores/counter'\n\n    const store = useCounterStore()\n</script>\n\n<template>\n    <div @click=\"store.inc()\">{{ store.counter }}</div>\n</template>\n"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"è‡ªåŠ¨æ³¨å†Œ","src":"/quick/img/autoUse.gif"},"children":[]}]},{"type":"element","tag":"br","props":{},"children":[]},{"type":"element","tag":"br","props":{},"children":[]},{"type":"element","tag":"h3","props":{"id":"è™šæ‹Ÿæ¨¡å—"},"children":[{"type":"element","tag":"a","props":{"href":"https://cn.vitejs.dev/guide/api-plugin.html#importing-a-virtual-file","rel":["nofollow"]},"children":[{"type":"text","value":"è™šæ‹Ÿæ¨¡å—"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"æˆ‘ä»¬éƒ½çŸ¥é“ "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"vite"}]},{"type":"text","value":" æ’ä»¶é‡Œæœ‰ä¸ªéå¸¸å¥½ç”¨çš„è™šæ‹Ÿæ–‡ä»¶æˆ–è€…è™šæ‹Ÿæ¨¡å—åŠŸèƒ½"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"ä¾‹å¦‚æˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ª "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"plugins/foo.js"}]},{"type":"text","value":" æ’ä»¶"}]},{"type":"element","tag":"code","props":{"code":"// plugins/foo.js\n// è™šæ‹Ÿæ¨¡å— id\nconst virtualModuleId = 'msg'\n// å¤„ç†ä¹‹åçš„è™šæ‹Ÿæ¨¡å— id\nconst resolvedVirtualModuleId = '\\0' + virtualModuleId\n// è™šæ‹Ÿæ¨¡å—ä»£ç \nconst code = `export default 100`\n\nexport default {\n    name: 'foo',\n    resolveId(id) {\n        if (id === virtualModuleId) {\n            return resolvedVirtualModuleId\n        }\n    },\n    load(id) {\n        if (id === resolvedVirtualModuleId) {\n            return code\n        }\n    }\n}\n","language":"js"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"// plugins/foo.js\n// è™šæ‹Ÿæ¨¡å— id\nconst virtualModuleId = 'msg'\n// å¤„ç†ä¹‹åçš„è™šæ‹Ÿæ¨¡å— id\nconst resolvedVirtualModuleId = '\\0' + virtualModuleId\n// è™šæ‹Ÿæ¨¡å—ä»£ç \nconst code = `export default 100`\n\nexport default {\n    name: 'foo',\n    resolveId(id) {\n        if (id === virtualModuleId) {\n            return resolvedVirtualModuleId\n        }\n    },\n    load(id) {\n        if (id === resolvedVirtualModuleId) {\n            return code\n        }\n    }\n}\n"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"ç„¶åæˆ‘ä»¬éœ€è¦æ³¨å†Œè¯¥æ’ä»¶"}]},{"type":"element","tag":"code","props":{"code":"import { defineConfig } from 'vite'\nimport vue from '@vitejs/plugin-vue'\nimport foo from './plugins/foo'\n\nexport default defineConfig({\n    plugins: [vue(), foo]\n})\n","language":"js"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"import { defineConfig } from 'vite'\nimport vue from '@vitejs/plugin-vue'\nimport foo from './plugins/foo'\n\nexport default defineConfig({\n    plugins: [vue(), foo]\n})\n"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"æœ€åå°±å¯ä»¥åœ¨å‰ç«¯é‡Œå¼•å…¥è¯¥è™šæ‹Ÿæ¨¡å—äº†ï¼Œä¾‹å¦‚ "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"src/main.js"}]},{"type":"text","value":" ä¸­"}]},{"type":"element","tag":"code","props":{"code":"// ...\nimport msg from 'msg'\n\nconsole.log(msg) // å°†åœ¨å‰ç«¯æ§åˆ¶å°è¾“å‡º 100\n// ...\n","language":"js"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"// ...\nimport msg from 'msg'\n\nconsole.log(msg) // å°†åœ¨å‰ç«¯æ§åˆ¶å°è¾“å‡º 100\n// ...\n"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"è™šæ‹Ÿæ¨¡å—","src":"/quick/img/virtualModule.gif"},"children":[]}]},{"type":"element","tag":"br","props":{},"children":[]},{"type":"element","tag":"br","props":{},"children":[]},{"type":"element","tag":"br","props":{},"children":[]},{"type":"element","tag":"h2","props":{"id":"å®ç°"},"children":[{"type":"text","value":"å®ç°"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"åŒç†ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åˆ›å»ºæºå¸¦ "},{"type":"element","tag":"a","props":{"href":"https://cn.vitejs.dev/guide/features.html#glob-import","rel":["nofollow"]},"children":[{"type":"text","value":"Glob å¯¼å…¥"}]},{"type":"text","value":" å®ç°è‡ªåŠ¨æ³¨å†Œ "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"vue"}]},{"type":"text","value":" æ¨¡å—çš„ä»£ç "}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"é¦–å…ˆåˆ›å»º "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"plugins/use-modules.js"}]},{"type":"text","value":" æ’ä»¶"}]},{"type":"element","tag":"code","props":{"code":"export default () => {\n    const virtualModuleId = 'virtual:modules'\n    const resolvedVirtualModuleId = '\\0' + virtualModuleId\n\n    const code = `\nexport const modules = import.meta.globEager(\n    '/src/modules/**/*.js'\n)\n\nexport const useModules = app => {\n    Object.values(modules).forEach(module => {\n        if (typeof module.default === 'function') {\n            module.default(app)\n        }\n    })\n}`\n\n    return {\n        name: 'vite-plugin-use-modules',\n        resolveId(id) {\n            if (id === virtualModuleId) {\n                return resolvedVirtualModuleId\n            }\n        },\n        load(id) {\n            if (id === resolvedVirtualModuleId) {\n                return code\n            }\n        }\n    }\n}\n","language":"js"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"export default () => {\n    const virtualModuleId = 'virtual:modules'\n    const resolvedVirtualModuleId = '\\0' + virtualModuleId\n\n    const code = `\nexport const modules = import.meta.globEager(\n    '/src/modules/**/*.js'\n)\n\nexport const useModules = app => {\n    Object.values(modules).forEach(module => {\n        if (typeof module.default === 'function') {\n            module.default(app)\n        }\n    })\n}`\n\n    return {\n        name: 'vite-plugin-use-modules',\n        resolveId(id) {\n            if (id === virtualModuleId) {\n                return resolvedVirtualModuleId\n            }\n        },\n        load(id) {\n            if (id === resolvedVirtualModuleId) {\n                return code\n            }\n        }\n    }\n}\n"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"ç„¶åæ³¨å†Œä¸€ä¸‹æ’ä»¶"}]},{"type":"element","tag":"code","props":{"code":"// vite.config.js\nimport { defineConfig } from 'vite'\nimport vue from '@vitejs/plugin-vue'\nimport Modules from './plugins/use-modules'\n\nexport default defineConfig({\n    plugins: [vue(), Modules()]\n})\n","language":"js"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"// vite.config.js\nimport { defineConfig } from 'vite'\nimport vue from '@vitejs/plugin-vue'\nimport Modules from './plugins/use-modules'\n\nexport default defineConfig({\n    plugins: [vue(), Modules()]\n})\n"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"æœ€åå°±å¯ä»¥åœ¨ "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"main.js"}]},{"type":"text","value":" ä¸­æ„‰å¿«çš„ä½¿ç”¨æ¨¡å—è‡ªåŠ¨åŠ è½½äº†"}]},{"type":"element","tag":"code","props":{"code":"import App from './App.vue'\nimport { createApp } from 'vue'\nimport { useModules } from 'virtual:modules'\n\nconst app = createApp(App)\n\nuseModules(app)\n\napp.mount('#app')\n","language":"js"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"import App from './App.vue'\nimport { createApp } from 'vue'\nimport { useModules } from 'virtual:modules'\n\nconst app = createApp(App)\n\nuseModules(app)\n\napp.mount('#app')\n"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"å®ç°","src":"/quick/img/useModules.gif"},"children":[]}]}]},"_type":"markdown","_id":"content:3.vite:1.plugins:2.use-modules.md","_source":"content","_file":"3.vite/1.plugins/2.use-modules.md","_extension":"md"},null]